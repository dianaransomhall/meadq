{
    "contents" : "#this function returns a list with the chemical names for corresponding\n#date, plate number and wells found in \"file\"\nchem.info.2.chgv<-function(file, masterChemFile=masterChemFile, debug=F) {\n  #get chemical info\n  #*********load chemical list*************\n  # read in masterChemFile\n  masterChem=read.csv(masterChemFile)\n  raw.masterCD<-as.data.frame(masterChem)\n  \n  # Do a check to make sure all data is there\n  actual.colnames<-colnames(raw.masterCD)\n  good.colnames<-c(\"Treatment\", \"Plate.SN\", \"Experiment Date\", \"Dose\",\"Project\",\n                   \"Units\", \"Genotype\", \"Pup\", \"Trt.DIV\",\"Well\" )\n  match.array<-sapply(actual.colnames, grepl, x=good.colnames,ignore.case=T) \n  stopifnot( all( apply(match.array, 1, any) ) ) #look for at least one match\n  #stop if each name doesn't have at least one match \n  \n  temp.masterCD=c()\n  #treatment \n  temp.masterCD$Treatment<-\n    raw.masterCD[ ,grepl(x=actual.colnames, pattern=\"Treat\", ignore.case=T ) ]\n  #Plate.SN \n  temp.masterCD$Plate.SN<-\n    raw.masterCD[ ,grepl(x=actual.colnames, pattern=\"Plate\", ignore.case=T ) ]\n  #Experiment Date\n  temp.masterCD$Experiment.Date<-\n    raw.masterCD[ ,grepl(x=actual.colnames, pattern=\"Experiment\", ignore.case=T ) ]\n  # Dose \n  temp.masterCD$Dose<-\n    raw.masterCD[ ,grepl(x=actual.colnames, pattern=\"Dose\", ignore.case=T ) ]\n  #Project \n  temp.masterCD$Project<-\n    raw.masterCD[ ,grepl(x=actual.colnames, pattern=\"Project\", ignore.case=T ) ]\n  #Units \n  temp.masterCD$Units<-\n    raw.masterCD[ ,grepl(x=actual.colnames, pattern=\"Units\", ignore.case=T ) ]\n  #Genotype \n  temp.masterCD$Genotype<-\n    raw.masterCD[ ,grepl(x=actual.colnames, pattern=\"Geno\", ignore.case=T ) ]\n  #Pup \n  temp.masterCD$Pup<-\n    raw.masterCD[ ,grepl(x=actual.colnames, pattern=\"Pup\", ignore.case=T ) ]\n  #Trt.DIV\n  temp.masterCD$Trt.DIV<-\n    raw.masterCD[ ,grepl(x=actual.colnames, pattern=\"Trt.DIV\", ignore.case=T ) ]\n  #well\n  temp.masterCD$Well<-\n    raw.masterCD[ ,grepl(x=actual.colnames, pattern=\"Well\", ignore.case=T ) ]\n  \n  #reconstruct file names\n  temp1<-paste(temp.masterCD$Project, temp.masterCD$Experiment.Date,\n               temp.masterCD$Plate.SN,sep=\"_\")\n  \n  #add a new column called masterCD$filenames\n  temp.masterCD$filename<-temp1\n  temp.masterCD<-as.data.frame(temp.masterCD)\n  ##############################################################3\n  if(debug){ print(temp.masterCD) }\n  \n  #ensure log file is ordered correctly so it can be read in correctly\n  masterCD<-temp.masterCD[order(temp.masterCD$Experiment.Date,temp.masterCD$Plate.SN,\n                                temp.masterCD$Well), ]\n  ################################################################\n  if(debug){ print(masterCD) }\n  #****match wells to chemicals *****\n  shortFileName<-paste( strsplit(basename(file),\"_\")[[1]][1],\n                        strsplit(basename(file),\"_\")[[1]][2],\n                        strsplit(basename(file),\"_\")[[1]][3],sep=\"_\")\n  \n  plate.chem.info=list(treatment=c(),dose=c(), units=c(),\n                       genotype=c(), pup=c(), trt.div=c(),well=c(),DIV=c())\n  count=1;\n  for (i in which(shortFileName==masterCD$filename) ){\n    #get all info from chem list\n    plate.chem.info$treatment[count]<-paste(masterCD$Treatment[i])\n    plate.chem.info$dose[count]<-paste(masterCD$Dose[i])\n    plate.chem.info$units[count]<-paste(masterCD$Units[i])\n    plate.chem.info$genotype[count]<-paste(masterCD$Genotype[i])\n    plate.chem.info$pup[count]<-paste(masterCD$Pup[i])\n    plate.chem.info$trt.div[count]<-paste(masterCD$Trt.DIV[i])\n    plate.chem.info$well[count]<-paste(masterCD$Well[i])\n    count=count+1\n    \n  }#end of for loop through masterCD$file\n  if(debug){ print(plate.chem.info) }\n  \n  if (!is.element(length(plate.chem.info$well),c(12,48)) ){\n    print(paste(\"Info exisits for \",length(plate.chem.info$well),\n                \" wells; Some wells have no data.\", sep=\"\"))\n  }\n  plate.chem.info\n}\n\n\n\n\n",
    "created" : 1408114893904.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1016601108",
    "id" : "A55224A4",
    "lastKnownWriteTime" : 1408115019,
    "path" : "F:/R/Rpackage_meadq/meadq/R/chem.info.2.chgv.R",
    "project_path" : "R/chem.info.2.chgv.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}